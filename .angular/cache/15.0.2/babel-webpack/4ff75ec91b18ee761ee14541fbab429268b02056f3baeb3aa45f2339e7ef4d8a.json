{"ast":null,"code":"import { GameConstants } from '../../constants/game-constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"../../pipes/get-name.pipe\";\nimport * as i3 from \"../../pipes/get-loses.pipe\";\nconst _c0 = [\"playerPlatforms\"];\n\nfunction PlayerPlatformsComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\")(2, \"div\")(3, \"h6\", 3);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"getPlayerName\");\n    i0.ɵɵpipe(6, \"getPlayerLoses\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const playerNum_r2 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵclassMapInterpolate1(\"player player-\", playerNum_r2, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMapInterpolate1(\"player-platform__wrapper player-platform__wrapper-\", playerNum_r2, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMapInterpolate1(\"player-platform player-platform__\", playerNum_r2, \"\");\n    i0.ɵɵstyleProp(\"left\", ctx_r1.getPlatformLeftPosition(playerNum_r2), \"px\");\n    i0.ɵɵclassProp(\"not-active\", !(ctx_r1.playersNumbers == null ? null : ctx_r1.playersNumbers.includes(playerNum_r2)));\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"active\", (ctx_r1.currentPlayer == null ? null : ctx_r1.currentPlayer.playerNumber) === playerNum_r2)(\"disabled\", !(ctx_r1.playersNumbers == null ? null : ctx_r1.playersNumbers.includes(playerNum_r2)));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", i0.ɵɵpipeBind2(5, 19, ctx_r1.allPlayers, playerNum_r2), \" \", i0.ɵɵpipeBind2(6, 22, ctx_r1.allPlayers, playerNum_r2), \" \");\n  }\n}\n\nexport class PlayerPlatformsComponent {\n  constructor(renderer, cdr) {\n    this.renderer = renderer;\n    this.cdr = cdr;\n    this.GameConstants = GameConstants;\n  }\n\n  ngOnInit() {// this.socket.on('connected', () => {\n    //     this.allPlayers.forEach(({ playerNumber, leftValue }) => {\n    //         this.renderPlatformStyle(this.gamePlatforms[playerNumber - 1], leftValue);\n    //     });\n    //     this.cdr.detectChanges();\n    // });\n    //\n    // this.socket.on('platformMoved', (data: { player: PlayerInterface }) => {\n    //     this.renderPlatformStyle(this.gamePlatforms[data.player.playerNumber - 1], data.player.leftValue);\n    // });\n  }\n\n  ngAfterViewInit() {\n    this.gamePlatforms = [...this.gameField.nativeElement.children].filter(gameFieldChild => gameFieldChild.classList?.contains(`player`)).flatMap(gameDivChild => [...gameDivChild.children].filter(child => child.classList?.contains(`player-platform__wrapper`))).map(platformWrapperDiv => [...platformWrapperDiv.children].find(platformWrapperChild => platformWrapperChild.classList?.contains(`player-platform`)));\n    this.currentPlayerPlatform = this.gamePlatforms[this.currentPlayer.playerNumber - 1];\n  }\n\n  renderPlatformStyle(platform, leftValue) {\n    this.renderer.setStyle(platform, 'left', `${leftValue}px`);\n  }\n\n  renderPlatformStyleAndEmitSocket(platform, leftValue, platformDirection) {\n    if (this.dropDirectionTimeOut) {\n      clearTimeout(this.dropDirectionTimeOut);\n    } // this.dropDirectionTimeOut = setTimeout(() => {\n    //     this.socket.emit('platformStopped');\n    // }, 300);\n    //\n    // this.renderPlatformStyle(platform, leftValue);\n    // this.socket.emit('platformMoved', { player: { ...this.currentPlayer, leftValue, platformDirection } });\n\n  }\n\n  getPlatformLeftPosition(playerNumber) {\n    const player = this.allPlayers.find(p => p.playerNumber === playerNumber);\n\n    if (!player) {\n      return 0;\n    }\n\n    return player.leftValue;\n  }\n\n  static #_ = this.ɵfac = function PlayerPlatformsComponent_Factory(t) {\n    return new (t || PlayerPlatformsComponent)(i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PlayerPlatformsComponent,\n    selectors: [[\"app-player-platforms\"]],\n    viewQuery: function PlayerPlatformsComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.gameField = _t.first);\n      }\n    },\n    inputs: {\n      playersNumbers: \"playersNumbers\",\n      currentPlayer: \"currentPlayer\",\n      allPlayers: \"allPlayers\"\n    },\n    decls: 3,\n    vars: 1,\n    consts: [[1, \"player-platforms__wrapper\"], [\"playerPlatforms\", \"\"], [3, \"class\", 4, \"ngFor\", \"ngForOf\"], [1, \"player-name\"]],\n    template: function PlayerPlatformsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0, 1);\n        i0.ɵɵtemplate(2, PlayerPlatformsComponent_div_2_Template, 7, 25, \"div\", 2);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.GameConstants.AllPlayerNumbers);\n      }\n    },\n    dependencies: [i1.NgForOf, i2.GetNamePipe, i3.GetLosesPipe],\n    styles: [\".player[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;width:100%}.player-name[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);-webkit-user-select:none;user-select:none;top:-20px;font-weight:400;width:max-content}.player-name.disabled[_ngcontent-%COMP%]{opacity:.35}.player-name.active[_ngcontent-%COMP%]{color:red}.player-1[_ngcontent-%COMP%]{top:-50px;left:50%;transform:translate(-50%)}.player-2[_ngcontent-%COMP%]{bottom:-50px;left:50%;transform:translate(-50%)}.player-3[_ngcontent-%COMP%]{left:-300px;top:50%;transform:translateY(-50%) rotate(270deg)}.player-4[_ngcontent-%COMP%]{right:-300px;top:50%;transform:translateY(-50%) rotate(90deg)}.player-platform[_ngcontent-%COMP%]{position:absolute;width:200px;height:20px;left:150px;top:0;background:#000}.player-platform-s__wrapper[_ngcontent-%COMP%]{height:100%;width:100%}.player-platform__2[_ngcontent-%COMP%]   .player-name[_ngcontent-%COMP%]{top:auto;bottom:-20px}.player-platform.not-active[_ngcontent-%COMP%]{left:0!important;width:100%;cursor:default}.player-platform__wrapper[_ngcontent-%COMP%]{position:absolute;width:100%;height:20px;background:#fff}.player-platform__wrapper-1[_ngcontent-%COMP%]{bottom:-50px}.player-platform__wrapper-2[_ngcontent-%COMP%]{top:-50px}.player-platform__wrapper-3[_ngcontent-%COMP%], .player-platform__wrapper-4[_ngcontent-%COMP%]{top:30px}\"],\n    changeDetection: 0\n  });\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}