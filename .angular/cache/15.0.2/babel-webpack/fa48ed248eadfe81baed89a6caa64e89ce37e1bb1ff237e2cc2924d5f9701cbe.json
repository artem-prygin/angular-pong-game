{"ast":null,"code":"import _asyncToGenerator from \"/home/artem/PhpstormProjects/angular-pong-game/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { GameConstants } from '../../constants/game-constants';\nimport { distinctUntilChanged, firstValueFrom, Subscription } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/game.service\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../player-platforms/player-platforms.component\";\n\nfunction GameComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3);\n    i0.ɵɵelement(2, \"app-player-platforms\", 4);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"playersNumbers\", ctx_r0.playersNumbers)(\"currentPlayer\", ctx_r0.currentPlayer)(\"allPlayers\", ctx_r0.allPlayers);\n  }\n}\n\nfunction GameComponent_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\", 5);\n    i0.ɵɵtext(1, \"Socket Connection Failed. Try again later\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport class GameComponent {\n  constructor(gameService, dialog, renderer, cdr) {\n    this.gameService = gameService;\n    this.dialog = dialog;\n    this.renderer = renderer;\n    this.cdr = cdr;\n    this.sub$ = new Subscription();\n    this.GameConstants = GameConstants;\n  } // private allPlayers$ = new Subject<PlayerInterface[]>();\n  // private playersNumbers$ = new Subject<number[]>();\n  // private loserPlayerNumber$ = new Subject<number>();\n  // private ballPosition$ = new Subject<BallPositionInterface>();\n\n\n  onKeyup(e) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const currentPlayer = yield firstValueFrom(_this.gameService.currentPlayer);\n      console.log(currentPlayer); // const { left } = window.getComputedStyle(this.currentPlayerPlatform);\n      // const leftPXValue = +left.replace('px', '');\n      // const gameFieldRects = this.gameField.nativeElement.getBoundingClientRect();\n      // const platformLeftRects = this.currentPlayerPlatform.getBoundingClientRect();\n      // const { playerNumber } = currentPlayer;\n      //\n      // switch (e.key) {\n      //     /* right and left arrows work only for players #1 and #2 */\n      //     case 'ArrowRight':\n      //         if (!GameConstants.HorizontalPlayerNumbers.includes(playerNumber) || platformLeftRects.right >= gameFieldRects.right) {\n      //             return;\n      //         }\n      //         this.renderPlatformStyleAndEmitSocket(this.currentPlayerPlatform, leftPXValue + 10, DirectionsEnum.RIGHT);\n      //         break;\n      //     case 'ArrowLeft':\n      //         if (!GameConstants.HorizontalPlayerNumbers.includes(playerNumber) || platformLeftRects.left <= gameFieldRects.left) {\n      //             return;\n      //         }\n      //         this.renderPlatformStyleAndEmitSocket(this.currentPlayerPlatform, leftPXValue - 10, DirectionsEnum.LEFT);\n      //         break;\n      //\n      //     /* up and down arrows work only for players #3 and #4 */\n      //     case 'ArrowUp':\n      //         if (GameConstants.HorizontalPlayerNumbers.includes(playerNumber) || platformLeftRects.top <= gameFieldRects.top) {\n      //             return;\n      //         }\n      //\n      //         if (currentPlayer.playerNumber === GameConstants.LeftSidePlayerNumber) {\n      //             this.renderPlatformStyleAndEmitSocket(this.currentPlayerPlatform, leftPXValue + 10, DirectionsEnum.TOP);\n      //         }\n      //\n      //         if (currentPlayer.playerNumber === GameConstants.RightSidePlayerNumber) {\n      //             this.renderPlatformStyleAndEmitSocket(this.currentPlayerPlatform, leftPXValue - 10, DirectionsEnum.TOP);\n      //         }\n      //         break;\n      //     case 'ArrowDown':\n      //         if (GameConstants.HorizontalPlayerNumbers.includes(playerNumber) || platformLeftRects.bottom >= gameFieldRects.bottom) {\n      //             return;\n      //         }\n      //\n      //         if (currentPlayer.playerNumber === GameConstants.LeftSidePlayerNumber) {\n      //             this.renderPlatformStyleAndEmitSocket(this.currentPlayerPlatform, leftPXValue - 10, DirectionsEnum.BOTTOM);\n      //         }\n      //\n      //         if (currentPlayer.playerNumber === GameConstants.RightSidePlayerNumber) {\n      //             this.renderPlatformStyleAndEmitSocket(this.currentPlayerPlatform, leftPXValue + 10, DirectionsEnum.BOTTOM);\n      //         }\n      //         break;\n      //     default:\n      //         break;\n      // }\n    })();\n  }\n\n  ngOnInit() {\n    this.gameService.handleSocketConnections();\n    this.sub$.add(this.gameService.socket$.subscribe(() => {\n      this.cdr.detectChanges();\n    }));\n    this.sub$.add(this.gameService.currentPlayer.pipe(distinctUntilChanged((a, b) => JSON.stringify(a) === JSON.stringify(b))).subscribe(currentPlayer => {\n      this.currentPlayer = currentPlayer;\n      this.cdr.detectChanges();\n    }));\n    this.sub$.add(this.gameService.playersNumbers.pipe(distinctUntilChanged((a, b) => JSON.stringify(a) === JSON.stringify(b))).subscribe(playersNumbers => {\n      this.playersNumbers = playersNumbers;\n      this.cdr.detectChanges();\n    }));\n    this.sub$.add(this.gameService.allPlayers.pipe(distinctUntilChanged((a, b) => JSON.stringify(a) === JSON.stringify(b))).subscribe(allPlayers => {\n      this.allPlayers = allPlayers;\n      this.cdr.detectChanges();\n    }));\n  }\n\n  static #_ = this.ɵfac = function GameComponent_Factory(t) {\n    return new (t || GameComponent)(i0.ɵɵdirectiveInject(i1.GameService), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: GameComponent,\n    selectors: [[\"app-game\"]],\n    hostBindings: function GameComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"keydown\", function GameComponent_keydown_HostBindingHandler($event) {\n          return ctx.onKeyup($event);\n        }, false, i0.ɵɵresolveWindow);\n      }\n    },\n    decls: 3,\n    vars: 2,\n    consts: [[\"class\", \"container\", 4, \"ngIf\", \"ngIfElse\"], [\"socketConnectionFailed\", \"\"], [1, \"container\"], [1, \"game-wrapper\"], [3, \"playersNumbers\", \"currentPlayer\", \"allPlayers\"], [1, \"m-40\"]],\n    template: function GameComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, GameComponent_div_0_Template, 3, 3, \"div\", 0);\n        i0.ɵɵtemplate(1, GameComponent_ng_template_1_Template, 2, 0, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(2);\n\n        i0.ɵɵproperty(\"ngIf\", ctx.gameService.socket == null ? null : ctx.gameService.socket.connected)(\"ngIfElse\", _r1);\n      }\n    },\n    dependencies: [i3.NgIf, i4.PlayerPlatformsComponent],\n    styles: [\".container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]{height:500px;width:500px;background:antiquewhite;position:relative}.m-40[_ngcontent-%COMP%]{margin:40px}\"],\n    changeDetection: 0\n  });\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}